# Inter-patient heterogeneity in CMS2 tumors

This folder contains the scripts created to study the inter-patient heterogeneity in the tumors classified as CMS2 in our set of samples. In particular, it contains the following scripts: 

* [27_InterPatient_Het_UMAP_Harmony_OnlyCMS2](https://github.com/alberto-valdeolivas/ST_CRC_CMS/blob/main/InterPatient_Heterogeneity/27_InterPatient_Het_UMAP_Harmony_OnlyCMS2.Rmd): In this script, we extract the tummor annotated spots of the CMS2 samples and integrate them into the same lower dimensional space (UMAP) after correcting for batch effect. Among others, it contains the scripts to generate Figure 3a-d and Supplementary Figure S21. 
* [28_InterPatient_DEA_OnlyCMS2](https://github.com/alberto-valdeolivas/ST_CRC_CMS/blob/main/InterPatient_Heterogeneity/28_InterPatient_DEA_OnlyCMS2.Rmd): This script contains the code to perform the differential gene expression analysis and overrepresentation analysis which resutls are displayed in the Supplementary table 3. 
* [29_InterPatient_PseudobulPathway_CMS2_TME](https://github.com/alberto-valdeolivas/ST_CRC_CMS/blob/main/InterPatient_Heterogeneity/29_InterPatient_PseudobulPathway_CMS2_TME.Rmd): This script contains the code to generate pseudobulk of the tumor and tumor-surrounding spots and compare their pathways activities between the different CMS2 tumor patients. Among others, it cotains the code to generate the Figure 3f. 
* [30_InterPatient_Pseudobulk_TFs_CMS2_TME](https://github.com/alberto-valdeolivas/ST_CRC_CMS/blob/main/InterPatient_Heterogeneity/30_InterPatient_Pseudobulk_TFs_CMS2_TME.Rmd): This script contains the code to generate pseudobulk of the tumor and tumor-surrounding spots and compare their TF activities between the different CMS2 tumor patients. 
